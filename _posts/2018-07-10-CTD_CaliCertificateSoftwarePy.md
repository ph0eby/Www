---
layout: post
title: CTD校准证书出具软件
date: 2018-07-10
categories: blog
tags: [CTD,校准证书,软件]
description: 这篇文章用于编写 CTD 部门的校准证书出具软件的编制需求和设计。
---

> CTD 部门的工作量很大，出证书占用的时间约有50%，所以如果能够把这个问题解决了，能够大大提高工作效率。给自己用也是可以把自己从繁重的工作中解放出来。

## 题记

飞飞已经完成了一个比较综合的证书出具系统软件。这个软件是用VC#开发的。虽然有各种问题，但是随着使用和功能迭代，这个将来会越来越好用。
他的思路和我不大一样。我的思路是，将获得原始数据按照特定的格式放到一个文件夹下，根据仪器的型号和测量范围，文件放进去后，那边证书（报告）就自动生成了。——但是，飞飞的思路还是要调用使用人的很多认知资源，这个调用很多认知资源的过程中，会因为使用者的熟练程度、对于背景知识的掌握程度（经验）、手动输入错误等原因，还是会对使用者造成困扰。
因此，我可以按照我的思路进行重新设计。再对整个大系统重新设计之前——这个将来再写。我先完成一个“小软件”——取数软件。

## 证书出具过程

### 资料准备
说明：对于出证书的人来说，他出证书需要下列物件：
- 3份纸质的原始记录：温度（T）、盐度（C）、压力（D），有些仪器会缺少C 或（和） D。T 记录包含了8个标准温度点的数据，C 包含8个盐度（电导率）标准点的数据，D 包含17个压力标准点的数据。
- 2个仪器的“示值”电子数据包：通常包含1个 T 文件夹📂（Tfolder）、1个 D 文件夹📂(Dfolder)。
- 将上述文件拿到手，将数据拷贝到相关文件夹下，等待处理。

### 取数

所谓的“取数”，是指获得这台被校准仪器在相应的校准参考点时产生的“仪器示值”。
这里的仪器示值，通常包含两层意思：一是，这个示值通常是多个数的“平均值”；第二是，这个数往往包含“原始值”——通常是频率值 N 值或者电压值 V。

对于 T 来说，要根据标准温度点记录的那个时间点往后推2~3min，从T原始数据中取得该参考点附近的几个到几十个甚至上百个数据，取平均值,作为该温度点的仪器指示值。这个过程通常是8个参考点，每个参考点均需要进行人工观察和判断从而取到这个温度点附近的数据。
对于 D 来说，要根据压力量程范围所确定的若干压力参考点，利用手动的方式调节砝码的多少，平衡的时间间隔往往难以统一——因为有的时候会不稳，要调节之后再继续稳定一会儿。同样的，压力传感器的采样间隔也是不一样的，存储的格式也是多种多样的。

问题1： 为什么需要人工判断呢？因为在现场操作仪器的时候会存在多种问题。例如，由于现场同时控制了 N 台仪器，N 台仪器不能同时进行Start和 Stop，另外，有的仪器是自容的需要后来取数，有的仪器是现场取数据的。很多仪器在一个大锅里面，相互之间可能会存在干扰的情况，例如，有的仪器到达温度点之后开启自身的泵，就会对隔壁附近的仪器造成干扰，这种干扰可能需要几秒甚至十几秒的时间才能忽略。
问题2：为什么每次取数的的量还不一样？因为不同的仪器的采样间隔是不同的，有的一秒钟出一个数，有的3秒，有的10秒出一个数，因此就会造成单位时间内获得的有效数据量不同。
问题3：还有什么困难？每个批次的来检的仪器的数据输出格式不同，有txt、cnv、csv、xls、xlsx、raw、cap 等多种格式，另外获得的数据里有大量的干扰项目。我们通常的做法是通过 excel 的分列的方法，使用分隔符，将需要的部分列表出来，保存为 excel 文件格式。然后再 excel 文件里再用肉眼在参考点附近，取数——取平均值（当然通常还包括该温度点对应原始值 N 或者 V）。有的时候，原始值 raw 和示值通常以两种格式的形式存放在两个文件里，你需要将这两个文件分别处理，通常的做法是将 raw 源数据拷贝到盛有指示值的一列旁边，一起进行处理。

### 数据处理

- 这一步有飞飞的软件可以用。当然也有特殊情况，无法做的。





## LOG
- 20180710傍晚创建，待迭代。
- 20180711中午增加了取数的题目和内容。
- 20180810 add new test.
